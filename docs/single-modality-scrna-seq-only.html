<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Single modality: scRNA-seq only | Epiregulon documentation</title>
  <meta name="description" content="<p>This book presents the Epiregulon package. We provide the tutorials showing different
scenarions in which the package can be usd to analyse single-cell data.</p>" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Single modality: scRNA-seq only | Epiregulon documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This book presents the Epiregulon package. We provide the tutorials showing different
scenarions in which the package can be usd to analyse single-cell data.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Single modality: scRNA-seq only | Epiregulon documentation" />
  
  <meta name="twitter:description" content="<p>This book presents the Epiregulon package. We provide the tutorials showing different
scenarions in which the package can be usd to analyse single-cell data.</p>" />
  

<meta name="author" content="Xiaosai Yao, Tomasz WÅ‚odarczyk" />


<meta name="date" content="2025-01-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="archr-workflow-and-different-weight-methods.html"/>
<link rel="next" href="contact.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Epiregulon documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> Installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html#installing-from-github"><i class="fa fa-check"></i><b>1.1</b> Installing from github</a></li>
<li class="chapter" data-level="1.2" data-path="installation.html"><a href="installation.html#installing-from-bioconductor"><i class="fa fa-check"></i><b>1.2</b> Installing from Bioconductor</a></li>
<li class="chapter" data-level="1.3" data-path="installation.html"><a href="installation.html#citation"><i class="fa fa-check"></i><b>1.3</b> Citation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>2</b> Data preparation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-preparation.html"><a href="data-preparation.html#constructing-a-singlecellexperiment-object"><i class="fa fa-check"></i><b>2.1</b> Constructing a SingleCellExperiment object</a></li>
<li class="chapter" data-level="2.2" data-path="data-preparation.html"><a href="data-preparation.html#starting-from-an-archr-object"><i class="fa fa-check"></i><b>2.2</b> Starting from an ArchR object</a></li>
<li class="chapter" data-level="2.3" data-path="data-preparation.html"><a href="data-preparation.html#starting-from-a-seuratsignac-object"><i class="fa fa-check"></i><b>2.3</b> Starting from a Seurat/Signac object</a></li>
<li class="chapter" data-level="2.4" data-path="data-preparation.html"><a href="data-preparation.html#starting-from-anndata"><i class="fa fa-check"></i><b>2.4</b> Starting from AnnData</a></li>
<li class="chapter" data-level="2.5" data-path="data-preparation.html"><a href="data-preparation.html#starting-from-10x-data-formats"><i class="fa fa-check"></i><b>2.5</b> Starting from 10x data formats</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-preparation.html"><a href="data-preparation.html#reading-from-.h5-file"><i class="fa fa-check"></i><b>2.5.1</b> Reading from .h5 file</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-preparation.html"><a href="data-preparation.html#reading-directly-from-a-10x-directory"><i class="fa fa-check"></i><b>2.5.2</b> Reading directly from a 10x directory</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-preparation.html"><a href="data-preparation.html#reading-directly-from-csv"><i class="fa fa-check"></i><b>2.6</b> Reading directly from CSV</a></li>
<li class="chapter" data-level="2.7" data-path="data-preparation.html"><a href="data-preparation.html#important-points"><i class="fa fa-check"></i><b>2.7</b> Important points</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html"><i class="fa fa-check"></i><b>3</b> Basic workflow with MultiAssayExperiment</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#data-preparation-1"><i class="fa fa-check"></i><b>3.1</b> Data preparation</a></li>
<li class="chapter" data-level="3.2" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#quick-start"><i class="fa fa-check"></i><b>3.2</b> Quick start</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#retrieve-bulk-tf-chip-seq-binding-sites"><i class="fa fa-check"></i><b>3.2.1</b> Retrieve bulk TF ChIP-seq binding sites</a></li>
<li class="chapter" data-level="3.2.2" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#link-atac-seq-peaks-to-target-genes"><i class="fa fa-check"></i><b>3.2.2</b> Link ATAC-seq peaks to target genes</a></li>
<li class="chapter" data-level="3.2.3" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#add-tf-motif-binding-to-peaks"><i class="fa fa-check"></i><b>3.2.3</b> Add TF motif binding to peaks</a></li>
<li class="chapter" data-level="3.2.4" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#generate-regulons"><i class="fa fa-check"></i><b>3.2.4</b> Generate regulons</a></li>
<li class="chapter" data-level="3.2.5" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#network-pruning-highly-recommended"><i class="fa fa-check"></i><b>3.2.5</b> Network pruning (highly recommended)</a></li>
<li class="chapter" data-level="3.2.6" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#add-weights"><i class="fa fa-check"></i><b>3.2.6</b> Add Weights</a></li>
<li class="chapter" data-level="3.2.7" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#optional-annotate-with-tf-motifs"><i class="fa fa-check"></i><b>3.2.7</b> (Optional) Annotate with TF motifs</a></li>
<li class="chapter" data-level="3.2.8" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#calculate-tf-activity"><i class="fa fa-check"></i><b>3.2.8</b> Calculate TF activity</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-workflow-with-multiassayexperiment.html"><a href="basic-workflow-with-multiassayexperiment.html#session-info"><i class="fa fa-check"></i><b>3.3</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html"><i class="fa fa-check"></i><b>4</b> Advanced workflow with MultiAssayExperiment</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#data-preparation-2"><i class="fa fa-check"></i><b>4.1</b> Data preparation</a></li>
<li class="chapter" data-level="4.2" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#retrieve-bulk-tf-chip-seq-binding-sites-1"><i class="fa fa-check"></i><b>4.2</b> Retrieve bulk TF ChIP-seq binding sites</a></li>
<li class="chapter" data-level="4.3" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#link-atacseq-peaks-to-target-genes"><i class="fa fa-check"></i><b>4.3</b> Link ATACseq peaks to target genes</a></li>
<li class="chapter" data-level="4.4" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#add-tf-motif-binding-to-peaks-1"><i class="fa fa-check"></i><b>4.4</b> Add TF motif binding to peaks</a></li>
<li class="chapter" data-level="4.5" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#generate-regulons-1"><i class="fa fa-check"></i><b>4.5</b> Generate regulons</a></li>
<li class="chapter" data-level="4.6" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#prune-network"><i class="fa fa-check"></i><b>4.6</b> Prune network</a></li>
<li class="chapter" data-level="4.7" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#add-weights-1"><i class="fa fa-check"></i><b>4.7</b> Add Weights</a></li>
<li class="chapter" data-level="4.8" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#calculate-tf-activity-1"><i class="fa fa-check"></i><b>4.8</b> Calculate TF activity</a></li>
<li class="chapter" data-level="4.9" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#differential-tf-activity-test"><i class="fa fa-check"></i><b>4.9</b> Differential TF activity test</a></li>
<li class="chapter" data-level="4.10" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#visualizing-tf-activities"><i class="fa fa-check"></i><b>4.10</b> Visualizing TF activities</a></li>
<li class="chapter" data-level="4.11" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#geneset-enrichment"><i class="fa fa-check"></i><b>4.11</b> Geneset enrichment</a></li>
<li class="chapter" data-level="4.12" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#differential-network-analysis"><i class="fa fa-check"></i><b>4.12</b> Differential Network analysis</a></li>
<li class="chapter" data-level="4.13" data-path="advanced-workflow-with-multiassayexperiment.html"><a href="advanced-workflow-with-multiassayexperiment.html#session-info-1"><i class="fa fa-check"></i><b>4.13</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html"><i class="fa fa-check"></i><b>5</b> ArchR workflow and different weight methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#data-preparation-3"><i class="fa fa-check"></i><b>5.1</b> Data preparation</a></li>
<li class="chapter" data-level="5.2" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#load-archr-project"><i class="fa fa-check"></i><b>5.2</b> Load ArchR project</a></li>
<li class="chapter" data-level="5.3" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#retrieve-matrices-from-archr-project"><i class="fa fa-check"></i><b>5.3</b> Retrieve matrices from ArchR project</a></li>
<li class="chapter" data-level="5.4" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#retrieve-bulk-tf-chip-seq-binding-sites-2"><i class="fa fa-check"></i><b>5.4</b> Retrieve bulk TF ChIP-seq binding sites</a></li>
<li class="chapter" data-level="5.5" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#link-atac-seq-peaks-to-target-genes-1"><i class="fa fa-check"></i><b>5.5</b> Link ATAC-seq peaks to target genes</a></li>
<li class="chapter" data-level="5.6" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#add-tf-motif-binding-to-peaks-2"><i class="fa fa-check"></i><b>5.6</b> Add TF motif binding to peaks</a></li>
<li class="chapter" data-level="5.7" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#generate-regulons-2"><i class="fa fa-check"></i><b>5.7</b> Generate regulons</a></li>
<li class="chapter" data-level="5.8" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#optional-annotate-with-tf-motifs-1"><i class="fa fa-check"></i><b>5.8</b> (Optional) Annotate with TF motifs</a></li>
<li class="chapter" data-level="5.9" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#prune-network-1"><i class="fa fa-check"></i><b>5.9</b> Prune network</a></li>
<li class="chapter" data-level="5.10" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#add-weights-2"><i class="fa fa-check"></i><b>5.10</b> Add Weights</a></li>
<li class="chapter" data-level="5.11" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#calculate-tf-activity-2"><i class="fa fa-check"></i><b>5.11</b> Calculate TF activity</a></li>
<li class="chapter" data-level="5.12" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#perform-differential-activity"><i class="fa fa-check"></i><b>5.12</b> Perform differential activity</a></li>
<li class="chapter" data-level="5.13" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#visualize-the-results"><i class="fa fa-check"></i><b>5.13</b> Visualize the results</a></li>
<li class="chapter" data-level="5.14" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#differential-network-analysis-1"><i class="fa fa-check"></i><b>5.14</b> Differential network analysis</a></li>
<li class="chapter" data-level="5.15" data-path="archr-workflow-and-different-weight-methods.html"><a href="archr-workflow-and-different-weight-methods.html#session-info-2"><i class="fa fa-check"></i><b>5.15</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html"><i class="fa fa-check"></i><b>6</b> Single modality: scRNA-seq only</a>
<ul>
<li class="chapter" data-level="6.1" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#load-regulon"><i class="fa fa-check"></i><b>6.1</b> Load regulon</a></li>
<li class="chapter" data-level="6.2" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#load-scrna-seq-data"><i class="fa fa-check"></i><b>6.2</b> Load scRNA-seq data</a></li>
<li class="chapter" data-level="6.3" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#calculate-activity"><i class="fa fa-check"></i><b>6.3</b> Calculate activity</a></li>
<li class="chapter" data-level="6.4" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#perform-differential-activity-1"><i class="fa fa-check"></i><b>6.4</b> Perform differential activity</a></li>
<li class="chapter" data-level="6.5" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#visualize-activity"><i class="fa fa-check"></i><b>6.5</b> Visualize activity</a></li>
<li class="chapter" data-level="6.6" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#pathway-enrichment"><i class="fa fa-check"></i><b>6.6</b> Pathway enrichment</a></li>
<li class="chapter" data-level="6.7" data-path="single-modality-scrna-seq-only.html"><a href="single-modality-scrna-seq-only.html#session-info-3"><i class="fa fa-check"></i><b>6.7</b> Session Info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="contact.html"><a href="contact.html"><i class="fa fa-check"></i><b>7</b> Contact</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epiregulon documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="single-modality-scrna-seq-only" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Single modality: scRNA-seq only<a href="single-modality-scrna-seq-only.html#single-modality-scrna-seq-only" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Epiregulon also supports transcription factor activity inference when users only have scRNA-seq. After all, multiome or scATAC-seq data is still relatively rare. To enable TF activity inference on scRNA-seq, users can supply a pre-constructed gene regulatory network. <a href="https://saezlab.github.io/dorothea/articles/dorothea.html">Dorothea</a> provides both human and mouse pre-constructed gene regulatory networks based on curated experimental and computational data. In this vignette, we bypass the regulon construction step and go straight to calculate TF activity from a Dorothea GRN.</p>
<div id="load-regulon" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Load regulon<a href="single-modality-scrna-seq-only.html#load-regulon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dorothea assigns confidence level to its regulons with A being the most confident (i.e.Â supported by multiple lines of evidence) and E being the least confident.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="single-modality-scrna-seq-only.html#cb395-1" tabindex="-1"></a><span class="fu">library</span>(dorothea)</span>
<span id="cb395-2"><a href="single-modality-scrna-seq-only.html#cb395-2" tabindex="-1"></a><span class="fu">data</span>(dorothea_mm, <span class="at">package =</span> <span class="st">&quot;dorothea&quot;</span>)</span>
<span id="cb395-3"><a href="single-modality-scrna-seq-only.html#cb395-3" tabindex="-1"></a>regulon <span class="ot">&lt;-</span> dorothea_mm </span>
<span id="cb395-4"><a href="single-modality-scrna-seq-only.html#cb395-4" tabindex="-1"></a></span>
<span id="cb395-5"><a href="single-modality-scrna-seq-only.html#cb395-5" tabindex="-1"></a><span class="co">#known tfs</span></span>
<span id="cb395-6"><a href="single-modality-scrna-seq-only.html#cb395-6" tabindex="-1"></a>genes_to_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Foxa1&quot;</span>, <span class="st">&quot;Neurod1&quot;</span>,<span class="st">&quot;Pdx1&quot;</span>,<span class="st">&quot;Arx&quot;</span>)</span></code></pre></div>
</div>
<div id="load-scrna-seq-data" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Load scRNA-seq data<a href="single-modality-scrna-seq-only.html#load-scrna-seq-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We download the raw counts of a mouse pancreas data set from <em><a href="https://bioconductor.org/packages/3.20/scRNAseq">scRNAseq</a></em>. We add normalized logcounts, perform dimension reduction and visualize the embeddings using <em><a href="https://bioconductor.org/packages/3.20/scater">scater</a></em>.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="single-modality-scrna-seq-only.html#cb396-1" tabindex="-1"></a><span class="fu">library</span>(scRNAseq)</span>
<span id="cb396-2"><a href="single-modality-scrna-seq-only.html#cb396-2" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb396-3"><a href="single-modality-scrna-seq-only.html#cb396-3" tabindex="-1"></a></span>
<span id="cb396-4"><a href="single-modality-scrna-seq-only.html#cb396-4" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">BaronPancreasData</span>(<span class="st">&#39;mouse&#39;</span>)</span>
<span id="cb396-5"><a href="single-modality-scrna-seq-only.html#cb396-5" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">logNormCounts</span>(sce)</span>
<span id="cb396-6"><a href="single-modality-scrna-seq-only.html#cb396-6" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(sce)</span>
<span id="cb396-7"><a href="single-modality-scrna-seq-only.html#cb396-7" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">runUMAP</span>(sce)</span>
<span id="cb396-8"><a href="single-modality-scrna-seq-only.html#cb396-8" tabindex="-1"></a></span>
<span id="cb396-9"><a href="single-modality-scrna-seq-only.html#cb396-9" tabindex="-1"></a><span class="fu">plotUMAP</span>(sce, <span class="at">colour_by =</span> <span class="st">&quot;label&quot;</span>, <span class="at">text_by =</span> <span class="st">&quot;label&quot;</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/load_scRNAseq_singlemodality_scRNA_only-1.png" width="672" /></p>
</div>
<div id="calculate-activity" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Calculate activity<a href="single-modality-scrna-seq-only.html#calculate-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Even though Dorothea provides weights under the mor column, we can achieve superior performance if we recompute the weights based on the correlation between tf and target gene expression based on our own data. We performed 2 steps, the first step is to add weights to the Dorothea regulons and the second step is to estimate the TF activity by taking the weighted average of the target gene expression.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="single-modality-scrna-seq-only.html#cb397-1" tabindex="-1"></a><span class="fu">library</span>(epiregulon)</span>
<span id="cb397-2"><a href="single-modality-scrna-seq-only.html#cb397-2" tabindex="-1"></a></span>
<span id="cb397-3"><a href="single-modality-scrna-seq-only.html#cb397-3" tabindex="-1"></a></span>
<span id="cb397-4"><a href="single-modality-scrna-seq-only.html#cb397-4" tabindex="-1"></a><span class="co">#Add weights to regulon. Default method (wilcoxon) cannot be used</span></span>
<span id="cb397-5"><a href="single-modality-scrna-seq-only.html#cb397-5" tabindex="-1"></a>regulon.ms <span class="ot">&lt;-</span> <span class="fu">addWeights</span>(<span class="at">regulon =</span> regulon,</span>
<span id="cb397-6"><a href="single-modality-scrna-seq-only.html#cb397-6" tabindex="-1"></a>                         <span class="at">expMatrix =</span> sce,</span>
<span id="cb397-7"><a href="single-modality-scrna-seq-only.html#cb397-7" tabindex="-1"></a>                         <span class="at">clusters =</span> sce<span class="sc">$</span>label,</span>
<span id="cb397-8"><a href="single-modality-scrna-seq-only.html#cb397-8" tabindex="-1"></a>                         <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">MulticoreParam</span>(),</span>
<span id="cb397-9"><a href="single-modality-scrna-seq-only.html#cb397-9" tabindex="-1"></a>                         <span class="at">method=</span><span class="st">&quot;corr&quot;</span>)</span>
<span id="cb397-10"><a href="single-modality-scrna-seq-only.html#cb397-10" tabindex="-1"></a></span>
<span id="cb397-11"><a href="single-modality-scrna-seq-only.html#cb397-11" tabindex="-1"></a><span class="co">#Calculate activity</span></span>
<span id="cb397-12"><a href="single-modality-scrna-seq-only.html#cb397-12" tabindex="-1"></a>score.combine <span class="ot">&lt;-</span> <span class="fu">calculateActivity</span>(sce, </span>
<span id="cb397-13"><a href="single-modality-scrna-seq-only.html#cb397-13" tabindex="-1"></a>                                   <span class="at">regulon =</span> regulon.ms, </span>
<span id="cb397-14"><a href="single-modality-scrna-seq-only.html#cb397-14" tabindex="-1"></a>                                   <span class="at">mode =</span> <span class="st">&quot;weight&quot;</span>, </span>
<span id="cb397-15"><a href="single-modality-scrna-seq-only.html#cb397-15" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">&quot;weightedMean&quot;</span>)</span></code></pre></div>
</div>
<div id="perform-differential-activity-1" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Perform differential activity<a href="single-modality-scrna-seq-only.html#perform-differential-activity-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="single-modality-scrna-seq-only.html#cb398-1" tabindex="-1"></a><span class="fu">library</span>(epiregulon.extra)</span>
<span id="cb398-2"><a href="single-modality-scrna-seq-only.html#cb398-2" tabindex="-1"></a>markers <span class="ot">&lt;-</span> <span class="fu">findDifferentialActivity</span>(<span class="at">activity_matrix =</span> score.combine, </span>
<span id="cb398-3"><a href="single-modality-scrna-seq-only.html#cb398-3" tabindex="-1"></a>                                    <span class="at">clusters =</span> sce<span class="sc">$</span>label, </span>
<span id="cb398-4"><a href="single-modality-scrna-seq-only.html#cb398-4" tabindex="-1"></a>                                    <span class="at">pval.type =</span> <span class="st">&quot;some&quot;</span>, </span>
<span id="cb398-5"><a href="single-modality-scrna-seq-only.html#cb398-5" tabindex="-1"></a>                                    <span class="at">direction =</span> <span class="st">&quot;up&quot;</span>, </span>
<span id="cb398-6"><a href="single-modality-scrna-seq-only.html#cb398-6" tabindex="-1"></a>                                    <span class="at">test.type =</span> <span class="st">&quot;t&quot;</span>)</span></code></pre></div>
<p>Take the top TFs</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="single-modality-scrna-seq-only.html#cb399-1" tabindex="-1"></a>markers.sig <span class="ot">&lt;-</span> <span class="fu">getSigGenes</span>(markers, <span class="at">topgenes =</span> <span class="dv">5</span> )</span></code></pre></div>
</div>
<div id="visualize-activity" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Visualize activity<a href="single-modality-scrna-seq-only.html#visualize-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally we visualize the TF activity by either UMAP, violin plots or bubble plots. We confirm the activity of known lineage factors Pdx1 and Neurod1 in beta cells, Arx in alpha cells and Foxa1 in ductal cells.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="single-modality-scrna-seq-only.html#cb400-1" tabindex="-1"></a><span class="co"># plot umap</span></span>
<span id="cb400-2"><a href="single-modality-scrna-seq-only.html#cb400-2" tabindex="-1"></a><span class="fu">plotActivityDim</span>(<span class="at">sce =</span> sce, </span>
<span id="cb400-3"><a href="single-modality-scrna-seq-only.html#cb400-3" tabindex="-1"></a>                <span class="at">activity_matrix =</span> score.combine,</span>
<span id="cb400-4"><a href="single-modality-scrna-seq-only.html#cb400-4" tabindex="-1"></a>                <span class="at">tf =</span> genes_to_plot, </span>
<span id="cb400-5"><a href="single-modality-scrna-seq-only.html#cb400-5" tabindex="-1"></a>                <span class="at">legend.label =</span> <span class="st">&quot;score&quot;</span>,</span>
<span id="cb400-6"><a href="single-modality-scrna-seq-only.html#cb400-6" tabindex="-1"></a>                <span class="at">point_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb400-7"><a href="single-modality-scrna-seq-only.html#cb400-7" tabindex="-1"></a>                <span class="at">dimtype =</span> <span class="st">&quot;UMAP&quot;</span>, </span>
<span id="cb400-8"><a href="single-modality-scrna-seq-only.html#cb400-8" tabindex="-1"></a>                <span class="at">label =</span> <span class="st">&quot;label&quot;</span>, </span>
<span id="cb400-9"><a href="single-modality-scrna-seq-only.html#cb400-9" tabindex="-1"></a>                <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb400-10"><a href="single-modality-scrna-seq-only.html#cb400-10" tabindex="-1"></a>                <span class="at">text_size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/visualization_singlemodality_scRNA_only-1.png" width="672" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="single-modality-scrna-seq-only.html#cb401-1" tabindex="-1"></a><span class="co"># plot violin plot</span></span>
<span id="cb401-2"><a href="single-modality-scrna-seq-only.html#cb401-2" tabindex="-1"></a><span class="fu">plotActivityViolin</span>(score.combine, </span>
<span id="cb401-3"><a href="single-modality-scrna-seq-only.html#cb401-3" tabindex="-1"></a>                   <span class="at">tf =</span> genes_to_plot,</span>
<span id="cb401-4"><a href="single-modality-scrna-seq-only.html#cb401-4" tabindex="-1"></a>                   <span class="at">clusters =</span> sce<span class="sc">$</span>label)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/visualization_singlemodality_scRNA_only-2.png" width="672" /></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="single-modality-scrna-seq-only.html#cb402-1" tabindex="-1"></a><span class="co"># plot bubble plot</span></span>
<span id="cb402-2"><a href="single-modality-scrna-seq-only.html#cb402-2" tabindex="-1"></a><span class="fu">plotBubble</span>(score.combine, </span>
<span id="cb402-3"><a href="single-modality-scrna-seq-only.html#cb402-3" tabindex="-1"></a>           <span class="at">tf =</span> genes_to_plot, </span>
<span id="cb402-4"><a href="single-modality-scrna-seq-only.html#cb402-4" tabindex="-1"></a>           <span class="at">clusters =</span> sce<span class="sc">$</span>label)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/visualization_singlemodality_scRNA_only-3.png" width="672" /></p>
<p>Plot bubble plot of differential TFs</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="single-modality-scrna-seq-only.html#cb403-1" tabindex="-1"></a><span class="fu">plotBubble</span>(score.combine, </span>
<span id="cb403-2"><a href="single-modality-scrna-seq-only.html#cb403-2" tabindex="-1"></a>           <span class="at">tf =</span> markers.sig<span class="sc">$</span>tf, </span>
<span id="cb403-3"><a href="single-modality-scrna-seq-only.html#cb403-3" tabindex="-1"></a>           <span class="at">clusters =</span> sce<span class="sc">$</span>label)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>We can adapt the epiregulon package to plot gene expression. When compared against TF activity, gene expression of Foxa1 and Arx has noisy signals and high dropout rates.
Epiregulon enhances the signal to noise ratio of TF activity and better resolves lineage differences.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="single-modality-scrna-seq-only.html#cb404-1" tabindex="-1"></a><span class="co"># plot umap</span></span>
<span id="cb404-2"><a href="single-modality-scrna-seq-only.html#cb404-2" tabindex="-1"></a><span class="fu">plotActivityDim</span>(<span class="at">sce =</span> sce, </span>
<span id="cb404-3"><a href="single-modality-scrna-seq-only.html#cb404-3" tabindex="-1"></a>                <span class="at">activity_matrix =</span> <span class="fu">logcounts</span>(sce),</span>
<span id="cb404-4"><a href="single-modality-scrna-seq-only.html#cb404-4" tabindex="-1"></a>                <span class="at">tf =</span> genes_to_plot, </span>
<span id="cb404-5"><a href="single-modality-scrna-seq-only.html#cb404-5" tabindex="-1"></a>                <span class="at">legend.label =</span> <span class="st">&quot;gex&quot;</span>,</span>
<span id="cb404-6"><a href="single-modality-scrna-seq-only.html#cb404-6" tabindex="-1"></a>                <span class="at">point_size =</span> <span class="fl">0.1</span>,</span>
<span id="cb404-7"><a href="single-modality-scrna-seq-only.html#cb404-7" tabindex="-1"></a>                <span class="at">dimtype =</span> <span class="st">&quot;UMAP&quot;</span>, </span>
<span id="cb404-8"><a href="single-modality-scrna-seq-only.html#cb404-8" tabindex="-1"></a>                <span class="at">label =</span> <span class="st">&quot;label&quot;</span>, </span>
<span id="cb404-9"><a href="single-modality-scrna-seq-only.html#cb404-9" tabindex="-1"></a>                <span class="at">combine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb404-10"><a href="single-modality-scrna-seq-only.html#cb404-10" tabindex="-1"></a>                <span class="at">text_size =</span> <span class="dv">2</span>,</span>
<span id="cb404-11"><a href="single-modality-scrna-seq-only.html#cb404-11" tabindex="-1"></a>                <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">&quot;gray&quot;</span>,<span class="st">&quot;blue&quot;</span>),</span>
<span id="cb404-12"><a href="single-modality-scrna-seq-only.html#cb404-12" tabindex="-1"></a>                <span class="at">limit =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/scRNAseq_scRNA_only-1.png" width="672" /></p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="single-modality-scrna-seq-only.html#cb405-1" tabindex="-1"></a><span class="co"># plot violin plot</span></span>
<span id="cb405-2"><a href="single-modality-scrna-seq-only.html#cb405-2" tabindex="-1"></a><span class="fu">plotActivityViolin</span>(<span class="fu">logcounts</span>(sce), </span>
<span id="cb405-3"><a href="single-modality-scrna-seq-only.html#cb405-3" tabindex="-1"></a>                   <span class="at">tf =</span> genes_to_plot,</span>
<span id="cb405-4"><a href="single-modality-scrna-seq-only.html#cb405-4" tabindex="-1"></a>                   <span class="at">clusters =</span> sce<span class="sc">$</span>label,</span>
<span id="cb405-5"><a href="single-modality-scrna-seq-only.html#cb405-5" tabindex="-1"></a>                   <span class="at">legend.label =</span> <span class="st">&quot;gex&quot;</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/scRNAseq_scRNA_only-2.png" width="672" /></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="single-modality-scrna-seq-only.html#cb406-1" tabindex="-1"></a><span class="co"># plot Bubble plot</span></span>
<span id="cb406-2"><a href="single-modality-scrna-seq-only.html#cb406-2" tabindex="-1"></a><span class="fu">plotBubble</span>(<span class="fu">logcounts</span>(sce), </span>
<span id="cb406-3"><a href="single-modality-scrna-seq-only.html#cb406-3" tabindex="-1"></a>           <span class="at">tf =</span> markers.sig<span class="sc">$</span>tf, </span>
<span id="cb406-4"><a href="single-modality-scrna-seq-only.html#cb406-4" tabindex="-1"></a>           <span class="at">clusters =</span> sce<span class="sc">$</span>label,</span>
<span id="cb406-5"><a href="single-modality-scrna-seq-only.html#cb406-5" tabindex="-1"></a>           <span class="at">legend.label =</span> <span class="st">&quot;gex&quot;</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We can visualize the target genes for transcription factors of interest</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="single-modality-scrna-seq-only.html#cb407-1" tabindex="-1"></a><span class="fu">plotHeatmapRegulon</span>(<span class="at">sce=</span>sce,</span>
<span id="cb407-2"><a href="single-modality-scrna-seq-only.html#cb407-2" tabindex="-1"></a>                   <span class="at">tfs=</span>genes_to_plot,</span>
<span id="cb407-3"><a href="single-modality-scrna-seq-only.html#cb407-3" tabindex="-1"></a>                   <span class="at">regulon=</span>regulon.ms,</span>
<span id="cb407-4"><a href="single-modality-scrna-seq-only.html#cb407-4" tabindex="-1"></a>                   <span class="at">regulon_cutoff=</span><span class="fl">0.5</span>,</span>
<span id="cb407-5"><a href="single-modality-scrna-seq-only.html#cb407-5" tabindex="-1"></a>                   <span class="at">downsample=</span><span class="dv">1000</span>,</span>
<span id="cb407-6"><a href="single-modality-scrna-seq-only.html#cb407-6" tabindex="-1"></a>                   <span class="at">cell_attributes=</span><span class="st">&quot;label&quot;</span>,</span>
<span id="cb407-7"><a href="single-modality-scrna-seq-only.html#cb407-7" tabindex="-1"></a>                   <span class="at">col_gap=</span><span class="st">&quot;label&quot;</span>,</span>
<span id="cb407-8"><a href="single-modality-scrna-seq-only.html#cb407-8" tabindex="-1"></a>                   <span class="at">exprs_values=</span><span class="st">&quot;logcounts&quot;</span>,</span>
<span id="cb407-9"><a href="single-modality-scrna-seq-only.html#cb407-9" tabindex="-1"></a>                   <span class="at">name=</span><span class="st">&quot;regulon heatmap&quot;</span>,</span>
<span id="cb407-10"><a href="single-modality-scrna-seq-only.html#cb407-10" tabindex="-1"></a>                   <span class="at">column_title_rot =</span> <span class="dv">45</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/unnamed-chunk-4-1.png" width="1152" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="single-modality-scrna-seq-only.html#cb408-1" tabindex="-1"></a><span class="fu">plotHeatmapActivity</span>(<span class="at">activity_matrix =</span> score.combine,</span>
<span id="cb408-2"><a href="single-modality-scrna-seq-only.html#cb408-2" tabindex="-1"></a>                    <span class="at">sce=</span>sce,</span>
<span id="cb408-3"><a href="single-modality-scrna-seq-only.html#cb408-3" tabindex="-1"></a>                    <span class="at">tfs=</span>genes_to_plot,</span>
<span id="cb408-4"><a href="single-modality-scrna-seq-only.html#cb408-4" tabindex="-1"></a>                    <span class="at">downsample=</span><span class="dv">1000</span>,</span>
<span id="cb408-5"><a href="single-modality-scrna-seq-only.html#cb408-5" tabindex="-1"></a>                    <span class="at">cell_attributes=</span><span class="st">&quot;label&quot;</span>,</span>
<span id="cb408-6"><a href="single-modality-scrna-seq-only.html#cb408-6" tabindex="-1"></a>                    <span class="at">col_gap=</span><span class="st">&quot;label&quot;</span>,</span>
<span id="cb408-7"><a href="single-modality-scrna-seq-only.html#cb408-7" tabindex="-1"></a>                    <span class="at">name=</span><span class="st">&quot;regulon heatmap&quot;</span>,</span>
<span id="cb408-8"><a href="single-modality-scrna-seq-only.html#cb408-8" tabindex="-1"></a>                    <span class="at">column_title_rot =</span> <span class="dv">45</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/unnamed-chunk-4-2.png" width="1152" /></p>
</div>
<div id="pathway-enrichment" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Pathway enrichment<a href="single-modality-scrna-seq-only.html#pathway-enrichment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes it is useful to understand what pathways are enriched in the regulons. We take the highly correlated target genes of a regulon and perform geneset enrichment using the enricher function from <a href="http://yulab-smu.top/biomedical-knowledge-mining-book/universal-api.html">clusterProfiler</a>.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="single-modality-scrna-seq-only.html#cb409-1" tabindex="-1"></a><span class="co">#retrieve genesets</span></span>
<span id="cb409-2"><a href="single-modality-scrna-seq-only.html#cb409-2" tabindex="-1"></a>H <span class="ot">&lt;-</span> EnrichmentBrowser<span class="sc">::</span><span class="fu">getGenesets</span>(<span class="at">org =</span> <span class="st">&quot;mmu&quot;</span>, </span>
<span id="cb409-3"><a href="single-modality-scrna-seq-only.html#cb409-3" tabindex="-1"></a>                                    <span class="at">db =</span> <span class="st">&quot;msigdb&quot;</span>, </span>
<span id="cb409-4"><a href="single-modality-scrna-seq-only.html#cb409-4" tabindex="-1"></a>                                    <span class="at">cat =</span> <span class="st">&quot;H&quot;</span>, </span>
<span id="cb409-5"><a href="single-modality-scrna-seq-only.html#cb409-5" tabindex="-1"></a>                                    <span class="at">gene.id.type =</span> <span class="st">&quot;SYMBOL&quot;</span>, </span>
<span id="cb409-6"><a href="single-modality-scrna-seq-only.html#cb409-6" tabindex="-1"></a>                                    <span class="at">cache =</span> <span class="cn">FALSE</span>)</span>
<span id="cb409-7"><a href="single-modality-scrna-seq-only.html#cb409-7" tabindex="-1"></a>C6 <span class="ot">&lt;-</span> EnrichmentBrowser<span class="sc">::</span><span class="fu">getGenesets</span>(<span class="at">org =</span> <span class="st">&quot;mmu&quot;</span>, </span>
<span id="cb409-8"><a href="single-modality-scrna-seq-only.html#cb409-8" tabindex="-1"></a>                                     <span class="at">db =</span> <span class="st">&quot;msigdb&quot;</span>, </span>
<span id="cb409-9"><a href="single-modality-scrna-seq-only.html#cb409-9" tabindex="-1"></a>                                     <span class="at">cat =</span> <span class="st">&quot;C6&quot;</span>, </span>
<span id="cb409-10"><a href="single-modality-scrna-seq-only.html#cb409-10" tabindex="-1"></a>                                     <span class="at">gene.id.type =</span> <span class="st">&quot;SYMBOL&quot;</span>,  </span>
<span id="cb409-11"><a href="single-modality-scrna-seq-only.html#cb409-11" tabindex="-1"></a>                                     <span class="at">cache =</span> <span class="cn">FALSE</span>)</span>
<span id="cb409-12"><a href="single-modality-scrna-seq-only.html#cb409-12" tabindex="-1"></a></span>
<span id="cb409-13"><a href="single-modality-scrna-seq-only.html#cb409-13" tabindex="-1"></a><span class="co">#combine genesets and convert genesets to be compatible with enricher</span></span>
<span id="cb409-14"><a href="single-modality-scrna-seq-only.html#cb409-14" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(H,C6)</span>
<span id="cb409-15"><a href="single-modality-scrna-seq-only.html#cb409-15" tabindex="-1"></a>gs.list <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,<span class="fu">lapply</span>(<span class="fu">names</span>(gs), <span class="cf">function</span>(x) </span>
<span id="cb409-16"><a href="single-modality-scrna-seq-only.html#cb409-16" tabindex="-1"></a>  {<span class="fu">data.frame</span>(<span class="at">gs =</span> x, <span class="at">genes =</span> gs[[x]])}))</span>
<span id="cb409-17"><a href="single-modality-scrna-seq-only.html#cb409-17" tabindex="-1"></a></span>
<span id="cb409-18"><a href="single-modality-scrna-seq-only.html#cb409-18" tabindex="-1"></a>enrichresults <span class="ot">&lt;-</span> <span class="fu">regulonEnrich</span>(genes_to_plot, </span>
<span id="cb409-19"><a href="single-modality-scrna-seq-only.html#cb409-19" tabindex="-1"></a>                               <span class="at">regulon =</span> regulon.ms, </span>
<span id="cb409-20"><a href="single-modality-scrna-seq-only.html#cb409-20" tabindex="-1"></a>                               <span class="at">weight =</span> <span class="st">&quot;weight&quot;</span>,</span>
<span id="cb409-21"><a href="single-modality-scrna-seq-only.html#cb409-21" tabindex="-1"></a>                               <span class="at">weight_cutoff =</span> <span class="fl">0.5</span>, </span>
<span id="cb409-22"><a href="single-modality-scrna-seq-only.html#cb409-22" tabindex="-1"></a>                               <span class="at">genesets =</span> gs.list)</span></code></pre></div>
<pre><code>## Foxa1</code></pre>
<pre><code>## </code></pre>
<pre><code>## Neurod1</code></pre>
<pre><code>## Pdx1</code></pre>
<pre><code>## Arx</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="single-modality-scrna-seq-only.html#cb415-1" tabindex="-1"></a><span class="co">#plot results</span></span>
<span id="cb415-2"><a href="single-modality-scrna-seq-only.html#cb415-2" tabindex="-1"></a><span class="fu">enrichPlot</span>(<span class="at">results =</span> enrichresults, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="scRNAseq.only_files/figure-html/enrichment_singlemodality_scRNA_only-1.png" width="672" /></p>
</div>
<div id="session-info-3" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Session Info<a href="single-modality-scrna-seq-only.html#session-info-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="single-modality-scrna-seq-only.html#cb416-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.4.0 (2024-04-24)
## Platform: x86_64-pc-linux-gnu
## Running under: Red Hat Enterprise Linux 8.6 (Ootpa)
## 
## Matrix products: default
## BLAS/LAPACK: /apps/rocs/2020.08/cascadelake/software/OpenBLAS/0.3.9-GCC-9.3.0/lib/libopenblas_skylakexp-r0.3.9.so;  LAPACK version 3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## time zone: America/Los_Angeles
## tzcode source: system (glibc)
## 
## attached base packages:
## [1] stats4    stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] org.Mm.eg.db_3.20.0         AnnotationDbi_1.67.0       
##  [3] msigdbr_7.5.1               epiregulon.extra_1.1.4     
##  [5] epiregulon_1.3.4            scater_1.33.4              
##  [7] ggplot2_3.5.1               scuttle_1.15.4             
##  [9] scRNAseq_2.19.1             SingleCellExperiment_1.27.2
## [11] SummarizedExperiment_1.35.4 Biobase_2.65.1             
## [13] GenomicRanges_1.57.2        GenomeInfoDb_1.41.2        
## [15] IRanges_2.39.2              S4Vectors_0.43.2           
## [17] BiocGenerics_0.51.3         MatrixGenerics_1.17.0      
## [19] matrixStats_1.4.1           dorothea_1.17.0            
## 
## loaded via a namespace (and not attached):
##   [1] fs_1.6.4                 ProtGenerics_1.37.1      bitops_1.0-9            
##   [4] enrichplot_1.25.3        httr_1.4.7               RColorBrewer_1.1-3      
##   [7] doParallel_1.0.17        Rgraphviz_2.49.1         tools_4.4.0             
##  [10] backports_1.5.0          alabaster.base_1.5.9     utf8_1.2.4              
##  [13] R6_2.5.1                 HDF5Array_1.33.8         lazyeval_0.2.2          
##  [16] uwot_0.2.2               rhdf5filters_1.17.0      GetoptLong_1.0.5        
##  [19] withr_3.0.1              gridExtra_2.3            cli_3.6.3               
##  [22] Cairo_1.6-2              scatterpie_0.2.4         alabaster.se_1.5.3      
##  [25] labeling_0.4.3           sass_0.4.9               KEGGgraph_1.65.0        
##  [28] yulab.utils_0.1.7        Rsamtools_2.21.2         gson_0.1.0              
##  [31] DOSE_3.99.1              R.utils_2.12.3           bcellViper_1.41.0       
##  [34] limma_3.61.12            rstudioapi_0.16.0        RSQLite_2.3.7           
##  [37] FNN_1.1.4.1              gridGraphics_0.5-1       generics_0.1.3          
##  [40] shape_1.4.6.1            BiocIO_1.15.2            dplyr_1.1.4             
##  [43] GO.db_3.20.0             Matrix_1.7-0             ggbeeswarm_0.7.2        
##  [46] fansi_1.0.6              abind_1.4-8              R.methodsS3_1.8.2       
##  [49] lifecycle_1.0.4          yaml_2.3.10              edgeR_4.3.19            
##  [52] qvalue_2.37.0            rhdf5_2.49.0             SparseArray_1.5.44      
##  [55] BiocFileCache_2.13.2     grid_4.4.0               blob_1.2.4              
##  [58] promises_1.3.0           dqrng_0.4.1              ExperimentHub_2.13.1    
##  [61] crayon_1.5.3             lattice_0.22-6           beachmat_2.21.6         
##  [64] cowplot_1.1.3            GenomicFeatures_1.57.1   annotate_1.83.0         
##  [67] chromote_0.3.1           KEGGREST_1.45.1          magick_2.8.5            
##  [70] pillar_1.9.0             knitr_1.48               ComplexHeatmap_2.21.1   
##  [73] metapod_1.13.0           fgsea_1.31.6             rjson_0.2.23            
##  [76] codetools_0.2-20         fastmatch_1.1-4          glue_1.8.0              
##  [79] ggfun_0.1.7              data.table_1.16.2        treeio_1.29.1           
##  [82] vctrs_0.6.5              png_0.1-8                gypsum_1.1.6            
##  [85] gtable_0.3.5             cachem_1.1.0             xfun_0.48               
##  [88] S4Arrays_1.5.10          tidygraph_1.3.1          iterators_1.0.14        
##  [91] statmod_1.5.0            bluster_1.15.1           nlme_3.1-166            
##  [94] ggtree_3.13.1            bit64_4.5.2              alabaster.ranges_1.5.2  
##  [97] filelock_1.0.3           bslib_0.8.0              irlba_2.3.5.1           
## [100] vipor_0.4.7              colorspace_2.1-1         DBI_1.2.3               
## [103] tidyselect_1.2.1         processx_3.8.4           bit_4.5.0               
## [106] compiler_4.4.0           curl_5.2.3               httr2_1.0.5             
## [109] graph_1.83.0             BiocNeighbors_1.99.2     DelayedArray_0.31.14    
## [112] shadowtext_0.1.4         bookdown_0.40            rtracklayer_1.65.0      
## [115] checkmate_2.3.2          scales_1.3.0             rappdirs_0.3.3          
## [118] stringr_1.5.1            digest_0.6.37            alabaster.matrix_1.5.10 
## [121] rmarkdown_2.28           XVector_0.45.0           htmltools_0.5.8.1       
## [124] pkgconfig_2.0.3          highr_0.11               dbplyr_2.5.0            
## [127] fastmap_1.2.0            ensembldb_2.29.1         rlang_1.1.4             
## [130] GlobalOptions_0.1.2      UCSC.utils_1.1.0         farver_2.1.2            
## [133] jquerylib_0.1.4          jsonlite_1.8.9           BiocParallel_1.39.0     
## [136] R.oo_1.26.0              GOSemSim_2.31.2          BiocSingular_1.21.4     
## [139] RCurl_1.98-1.16          magrittr_2.0.3           ggplotify_0.1.2         
## [142] GenomeInfoDbData_1.2.13  patchwork_1.3.0          Rhdf5lib_1.27.0         
## [145] munsell_0.5.1            Rcpp_1.0.13              ape_5.8                 
## [148] babelgene_22.9           viridis_0.6.5            EnrichmentBrowser_2.35.1
## [151] stringi_1.8.4            alabaster.schemas_1.5.0  ggraph_2.2.1            
## [154] zlibbioc_1.51.1          MASS_7.3-61              AnnotationHub_3.13.3    
## [157] plyr_1.8.9               parallel_4.4.0           ggrepel_0.9.6           
## [160] splines_4.4.0            Biostrings_2.73.2        graphlayouts_1.2.0      
## [163] circlize_0.4.16          locfit_1.5-9.10          ps_1.8.0                
## [166] igraph_2.0.3             reshape2_1.4.4           ScaledMatrix_1.13.0     
## [169] BiocVersion_3.20.0       XML_3.99-0.17            evaluate_1.0.1          
## [172] scran_1.33.2             BiocManager_1.30.25      foreach_1.5.2           
## [175] tweenr_2.0.3             tidyr_1.3.1              purrr_1.0.2             
## [178] polyclip_1.10-7          clue_0.3-65              alabaster.sce_1.5.1     
## [181] ggforce_0.4.2            rsvd_1.0.5               xtable_1.8-4            
## [184] restfulr_0.0.15          AnnotationFilter_1.29.0  tidytree_0.4.6          
## [187] later_1.3.2              viridisLite_0.4.2        tibble_3.2.1            
## [190] aplot_0.2.3              clusterProfiler_4.13.4   websocket_1.4.2         
## [193] memoise_2.0.1            beeswarm_0.4.0           GenomicAlignments_1.41.0
## [196] cluster_2.1.6            GSEABase_1.67.0          BiocStyle_2.33.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="archr-workflow-and-different-weight-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="contact.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/scRNAseq.only.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Epiregulon documentation.pdf", "Epiregulon documentation.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
